<section xml:id="non-linear-coordinates">
  <title>Non-Linear Coordinate Systems</title>
  <subsection xml:id="polar-coordinates">
    <title>Polar Coordinates</title>
    <p>
      One way of thinking of transformations of <m>\RR^n</m> is as
      changes of coordinates. In <m>\RR^2</m>, with standard
      coordinates <m>x,y</m>, we can think of a linear transformation,
      say <m>u = x+v</m> and <m>v=x-v</m>, as a new system of
      coordinates. We can describe points, loci, and any other
      objects in terms of <m>u</m> and <m>v</m> just as well as in
      terms of <m>x</m> and <m>y</m>. The transformation tells us how
      to go between the two sets of coordinates.
    </p>
    <p>
      All the linear transformations mentioned in the previous section
      (at least those which preserve dimension) are changes of
      coordinates. In this section, we look at changing to new
      coordinates in stranger ways; in particular, we look as
      non-linear transformations.
    </p>
    <p>
      In <m>\RR^2</m>, the most common non-linear coordinate system is
      polar coordinates. Polar coordinates describe <m>\RR^2</m> in
      terms of circles and rays instead of the conventional lines of
      Cartesian coordinates. The system has two parameters
      (coordinates): <m>r</m> and <m>\theta</m>. <m>r</m>, the
      radius, is the distance of a point from the origin. We have
      <m>r \in [0, \infty)</m>, since that distance can't be negative.
      If we draw a ray from the origin to a point, <m>\theta</m> is
      the angle between that line and the <m>x</m> axis, with the
      convention that <m>\theta \in [0, 2\pi)</m>.
    </p>
    <figure xml:id="figure-polar-coordinates">
      <caption>Polar Coordinates</caption>
      <image xml:id="figure26" width="90%">
        <asymptote>
          size(12cm,7cm,IgnoreAspect);
          import graph;

          xlimits(-1,3);
          ylimits(-1,3);

          xaxis(Ticks("%"));
          yaxis(Ticks("%"));

          draw((0,0)--(2,2),Arrow); 
          draw((2,2)--(2,0),Arrow); 

          label("$r$",(1,1),NW);
          label("$(x,y) \ or \ (r,\theta)$",(2,2),E);
          label("$y$",(2,1),E);
          label("$x$",(1,-0.1),S);
          label("$\theta$",(0.2,0.1),E);
        </asymptote>
      </image>
    </figure>
    <p>
      We would like to be able to move between Cartesian and polar
      coordinates. To that end, we need to describe <m>x</m> and
      <m>y</m> in terms of <m>r</m> and <m>\theta</m>, and vice-versa.
      The relationships are just trigonometry.
      <me>
        x = r \cos \theta y = r \sin \theta
      </me>
    </p>
    <p>
      The reverse direction is also trigonometry.
      <me>
        r = \sqrt{x^2 + y^2} \tan \theta = \frac{y}{x}
        \implies \theta = \arctan \frac{y}{x}
      </me>
    </p>
    <p>
      If <m>x</m> is zero, then <m>\tan \theta</m> is undefined, but
      <m>\theta</m> will be <m>\pi/2</m> or <m>3\pi/2</m>, depending
      on whether <m>y</m> is positive or negative. If <m>x</m> and
      <m>y</m> are both zero, at the origin, the angle is not defined
      at all.
    </p>
    <p>
      Loci in <m>\RR^2</m> are equations in <m>x</m> and <m>y</m>.
      The simplest such loci were <m>x=c</m>, which is a vertical
      line, and <m>y=c</m>, which is a horizontal line. We get loci
      in <m>\RR^2</m> in terms of <m>r</m> and <m>\theta</m> as well.
      <m>r=c</m> is a circle: the shape with any angle and a fixed
      radius. <m>\theta =c</m> is a ray: the shape with a fixed angle
      and any radius. Polar loci are show in 
      <xref ref="figure-polar-locus1" />, 
      <xref ref="figure-polar-locus2" />, 
      <xref ref="figure-polar-locus3" /> and 
      <xref ref="figure-polar-locus4" />.
    </p>
    <p>
      To translate between loci in polar coordinates and loci in
      Cartesian coordinates is simply a matter of replacement. The
      line <m>x=4</m> in Cartesian coordinates becomes <m>r\cos \theta
      = 4</m> or <m>\cos \theta = \frac{r}{4}</m>. The circle <m>x^2
      + y^2 =1</m> becomes <m>r^2 \cos^2 \theta + r^2 \sin^2 \theta =
      1</m>, which is simply <m>r^2 = 1 \implies r=1</m>. The polar
      locus <m>r=\theta</m> becomes <m>\sqrt{x^2 + y^2} = \arctan
      \frac{y}{x}</m>.
    </p>
    <figure xml:id="figure-polar-locus1">
      <caption><m>r = \theta</m></caption>
      <image xml:id="figure27" width="90%">
        <asymptote>
          size(7cm,7cm);
          import graph;
          usepackage("remdefs");

          xlimits(-3,3);
          ylimits(-3,3);

          xaxis("$x$",above=true);
          yaxis("$y$",above=true);

          real f(real t) {return t/6;}

          path g=polargraph(f,0,5pi)--cycle;
          draw(g);
        </asymptote>
      </image>
    </figure>
    <figure xml:id="figure-polar-locus2">
      <caption><m>r = |\sin \theta|</m></caption>
      <image xml:id="figure28" width="90%"> 
        <asymptote>
          size(7cm,7cm);
          import graph;

          xlimits(-1.2,1.2);
          ylimits(-1.2,1.2);
          
          xaxis("$x$",above=true);
          yaxis("$y$",above=true);

          real f(real t) {return sqrt((sin(t))^2);}

          path g=polargraph(f,0,2pi)--cycle;
          draw(g);
        </asymptote>
      </image>
    </figure>
    <figure xml:id="figure-polar-locus3">
      <caption><m>r = 1 + \sin \theta</m></caption>
      <image xml:id="figure29" width="90%">
        <asymptote>
          size(7cm,7cm);
          import graph;

          xlimits(-2,2);
          ylimits(-1,3);

          xaxis("$x$",above=true);
          yaxis("$y$",above=true);

          real f(real t) {return 1 + sin(t);}

          path g=polargraph(f,0,2pi)--cycle;
          draw(g);
        </asymptote>
      </image>
    </figure>
    <figure xml:id="figure-polar-locus4">
      <caption><m>r = 3 \sin 2 \theta</m></caption>
      <image xml:id="figure30" width="90%">
        <asymptote>
          size(7cm,7cm);
          import graph;

          xlimits(-3,3);
          ylimits(-3,3);

          xaxis("$x$",above=true);
          yaxis("$y$",above=true);

          real f(real t) {return sqrt((3*sin(2*t))^2);}

          path g=polargraph(f,0,2pi)--cycle;
          draw(g);
        </asymptote>
      </image>
    </figure>
  </subsection>
  <subsection xml:id="spherical-cylindrical">
    <title>Spherical and Cylindrical Coordinates</title>
    <p>
      In <m>\RR^3</m>, there two are similar coordinate systems.
      Cylindrical coordinates use polar coordinates in the <m>xy</m>
      plane and leave the <m>z</m> coordinate unchanaged. The
      transformations are again given by trigonometry.
      <md>
        <mrow>
          x \amp = r \cos \theta
        </mrow>
        <mrow>
          y \amp = r \sin \theta
        </mrow>
        <mrow>
          z \amp = z
        </mrow>
      </md>
    </p>
    <p>
      We can invert the transformation.
      <md>
        <mrow>
          r \amp = \sqrt{x^2 + y^2}
        </mrow>
        <mrow>
          \theta \amp = \arctan \left( \frac{y}{x} \right)
        </mrow>
        <mrow>
          z \amp = z
        </mrow>
      </md>
    </p>
    <p>
      These are called cylindrical coordinates since the equation
      <m>r=c</m> gives rise to a infinitely tall cylinder. <m>r=c</m>
      in the <m>xy</m> plane is a circle, as before. The <m>z</m>
      coordinate is left free, so the circle can be located at any
      <m>z</m> value. That infinitely tall stack of circles is a
      cylinder.
    </p>
    <p>
      Spherical coordinates uses a sphere the same way that polar
      coordinates uses a circle. There is a radius term <m>r</m>,
      which measure the distance from a point to the origin in
      <m>\RR^3</m>. <m>r</m> determines the size of a sphere on which
      the point is located. After determining a sphere, to find a
      specific point on the sphere, we use a system which is similar
      to the system of longitude and latitude on the surface of the
      earth. <m>\theta</m> is the same as longitude, but with
      <m>\theta \in [0, 2\pi)</m> instead of counting positively in
      both east and west directions. The <m>0</m> line of longitude
      is the line that passes through the positive <m>x</m> axis.
      <m>\phi</m> is co-latitude instead of latitude: it starts at
      <m>0</m> at the top of the sphere and counts down to <m>\pi</m>
      radians at the bottom of the sphere. The transformations
      involve some tricky trigonometry in <m>\RR^3</m>.
      <md>
        <mrow>
          x \amp = r \sin \phi \cos \theta
        </mrow>
        <mrow>
          y \amp = r \sin \phi \sin \theta
        </mrow>
        <mrow>
          z \amp = r \cos \phi
        </mrow>
      </md>
    </p>
    <p>
      We can invert the transformation.
      <md>
        <mrow>
          r \amp = \sqrt{x^2 + y^2 + z^2}
        </mrow>
        <mrow>
          \theta \amp = \arctan \left( \frac{y}{x} \right)
        </mrow>
        <mrow>
          \phi \amp = \arctan \left( \frac{\sqrt{x^2 + y^2}}{z}
          \right)
        </mrow>
      </md>
    </p>
    <p>
      The equation <m>r=c</m> in spherical coordinates gives a
      sphere.
    </p>
  </subsection>
</section>
